\chapter{Redmine}\label{chp:redmine}

\section{Introdução}\label{sec:redmine-introducao}
Neste capítulo vamos explicar como o Redmine, uma ferramenta de gerenciamento de projetos foi utilizada para gestão de processos, ilustrando com um exemplo. Vamos apresentar ainda, a capacidade extensiva desta ferramenta através do desenvolvimento de plugins. Por último vamos abordar as limitações do Redmine que nos motivaram a desenvolver algo novo para atingir nosso objetivo em automatização de processos.
O Redmine\cite{redmine} é uma ferramenta de gerenciamento de projetos open-source. Foi criada por Jean-Philippe Lang em 2006. Desenvolvido em Ruby, utilizando a framework Rails, tem como objetivo dar flexibilidade de configuração ao usuário, e também ao desenvolvedor. A versão 3.1 deste software foi utilizada neste trabalho.


\section{Estrutura básica do Redmine}\label{sec:redmine-estrutura_basica}

A estrutura básica de gerenciamento de projetos no Redmine é composta por 6 principais elementos. São eles:

\subsection{Tarefas}\label{subsection:redmine-estrutura_basica-tarefa}

São as unidades básicas de execução de trabalho dos projetos (\ref{subsection:redmine-estrutura_basica-projeto}). Elas contém os dados relevantes para o seu gerenciamento (e.g, tipo (\ref{subsection:redmine-estrutura_basica-tracker}), situação (\ref{subsection:redmine-estrutura_basica-status})), para a sua execução (e.g, título, descrição) e dados adicionais que podem variar entre os projetos e tipos de tarefa, que são cadastrados como campos personalizados (\ref{subsection:redmine-estrutura_basica-custom_fields}).  

\subsection{Projetos}\label{subsection:redmine-estrutura_basica-projeto}

Projetos são o objeto central do Redmine. Eles são compostos por diversos módulos que acrescentam diferentes dimensões para o seu gerenciamento, como gerenciamento de tarefas, planejamento de versões, acompanhamento do progresso das tarefas em um diagrama de Gantt, Wiki para organização do conhecimento, entre outros. 

\subsection{Tipos de tarefa}\label{subsection:redmine-estrutura_basica-tracker}

Tipos de tarefa definem o fluxo de trabalho para a realização de atividades similares. De acordo com o tipo, variam as informações necessárias para a execução da tarefa, a sequência de passos para sua conclusão e as ações que cada membro do projeto pode desempenhar em cada etapa.

\subsection{Situação}\label{subsection:redmine-estrutura_basica-status}

Situação indica em qual etapa do processo uma tarefa se encontra. É usada para definir as ações possíveis pelos membros do projeto. Essas ações podem ser diferentes para cada tipo de tarefa.

\subsection{Papéis de usuários}\label{subsection:redmine-estrutura_basica-role}

Os papéis de usuários definem quais permissões um usuário possui, como, por exemplo, visualizar, adicionar e editar tarefas, editar Wiki, adicionar e editar documentos. Os papéis são atribuídos aos usuários em cada projeto que ele participa, portanto, ele pode possuir permissões diferentes dependendo do projeto de que ele é membro.

\subsection{Campos Personalizados}\label{subsection:redmine-estrutura_basica-custom_fields}

Todas as tarefas de projetos possuem dados em comum, como data de início, data de término e descrição. No entanto, dependendo das especificidades de um projeto ou tipo de tarefa, podem ser necessárias informações adicionais. Para esses casos existem os campos personalizados. Eles permitem criar novos campos e adicioná-los às tarefas, estendendo as configurações padrão da ferramenta.

\section{Gestão de processos com o Redmine}\label{sec:redmine-gestao_processos}

A estrutura de projetos do Redmine é altamente configurável. Todos os elementos explicados na seção \ref{sec:redmine-estrutura_basica} são cadastrados pelos usuários administradores do sistema, que são responsáveis por configurá-los e personalizá-los para atender às demandas de cada projeto.

Todas as configurações e personalizações citadas no último parágrafo são feitas exclusivamente pela interface da ferramenta, sem necessidade de alterações no código da aplicação ou arquivos de configuração, o que confere aos administradores capacidade para modelar a estrutura da ferramenta da forma que for mais conveniente para a necessidade dos usuários.

Devido a sua natureza adaptável e ferramentas de gerenciamento de tarefas e de conhecimento, o Redmine pode ser utilizado, também, em outros contextos, como no gerenciamento de processos de negócio.


\section{Como automatizar um processo?}\label{sec:redmine-automatizar_processo}

O primeiro passo para modelar um processo é identificar como representá-lo na estrutura do Redmine.

Nesta seção descreveremos como utilizar o potencial de configuração do Redmine para utilizá-lo fora do contexto de gerenciamento de projetos e aplicá-lo como ferramenta de automatização de processos. Explicaremos, também, como definir os atores de um processo, as ações permitidas a cada um deles, especificar os fluxos de trabalho e como gerenciar os dados relevantes ao seu contexto. Estes passos serão ilustrados na implementação do caso de uso descrito na figura \ref{fig:exemplo_bpmn}.


\subsection{Modelando processos}\label{subsection:redmine-automatizar_processo-criacao}

É nos tipos de tarefa que definimos as etapas de um processo, representadas pelas situações (\ref{subsection:redmine-estrutura_basica-status}), quais campos (\ref{subsection:redmine-estrutura_basica-custom_fields}) são utilizados para guardar informações relativas à execução de um processo.

Durante a criação do tipo de tarefa são definidas qual situação (\ref{subsection:redmine-estrutura_basica-status}) é a padrão aquele tipo, em quais projetos ele é utilizado e quais campos (\ref{subsection:redmine-estrutura_basica-custom_fields}) ele utiliza para guardar informações.


\subsection{Definição dos atores}\label{subsection:redmine-automatizar_processo-atores}

\subsubsection{Escolha dos atores}

Os atores de um processo são definidos nos projetos que o tipo de tarefa está relacionado. Ao associar um papel a um usuário (ou grupo de usuários) é definido quais papéis ele terá naquele projeto - no caso de um grupo de usuários ser associado a um projeto, todos os seus membros herdarão os papéis atribuídos a ele.

\subsubsection{Definição das permissões dos atores}

As permissões dos atores do processo são definidas nos papéis de usuários (\ref{subsection:redmine-estrutura_basica-role}). Neles é possível escolher se um usuário pode ter tarefas atribuídas a ele, quais tarefas ele consegue visualizar e quais ações ele é capaz de realizar sobre as tarefas (e.g. Ver Chamados, Editar Chamados, Adicionar Chamados, Adicionar Notas).

\subsection{Fluxo de trabalho}

A configuração do fluxo de trabalho é onde se orquestra o processo e define-se como os usuários podem manipular os dados dos chamados. Essa configuração é divida em duas partes, permissão de campos e transição de estados, e é feita separadamente para cada papel.

As permissões de campos ditam de que forma um usuário pode interagir com os campos dos chamados que pode editar dependendo da situação atual do chamado. Baseado nessas permissões um campo pode ficar disponível somente para leitura, editável, ou obrigatório.

A transição de estados define para quais situações um chamado pode ser alterado de acordo com o estado atual, determinando para quais etapas de um processo um usuário consegue conduzir a tarefa.

\section{Plugins}\label{sec:redmine-plugins}
O Redmine foi desenvolvido de forma a ser extensível por meio de plugins. É possível modificar um funcionalidade da ferramenta, ou criar novas funcionalidades sem precisar alterar o código desta. Os plugins são desenvolvidos em Rails, a mesma linguagem de programação do Redmine. 

Para possibilitar extensões de funcionalidades que envolvem enxertar pedaços de código no meio de uma classe ou de uma tela, o Redmine disponibiliza hooks em diversas partes da ferramenta. São tags com um identificador da parte do código em que estão inseridas. E para utilizar este hook basta incluir um hook listener num plugin, e direcionar qual arquivo ou método um determinado hook vai disparar.

\section{Precificação manual}\label{sec:redmine-impl-caso-uso}

Para implementar o caso de uso foi criado um tipo de tarefa chamado Precificação manual. Também foram criadas as situações Novo, Solicitar troca de preço, Aguardando aprovação, Não aprovado, Trocar preço, Encerrado.

As situações acima representam cada etapa do processo, que na modelagem em bpmn são caixinhas. A transição de situação é feita pelo responsável pela tarefa naquele momento, que também altera para o novo responsável na próxima etapa, caso necessário. A etapa de troca de preço consiste da operação de um sistema externo, e assim que concluída, o responsável conclui o processo, passando-o para a próxima etapa.

Esta implementação mostra como processos simples podem ser modelados no Redmine desta forma, se aproveitando de toda a sua estrutura de tarefas. Desta forma é possível que um usuário acompanhe processos, execute etapas manuais no processo, preenchendo formulários, e tomando decisões as próximas etapas, como a etapa de aprovação.

A ferramenta escolhida se mostrou uma solução barata, de rápida implementação, e que permite que o próprio usuário administrador fique responsável pela manutenção. Muitos cenários problemáticos, como apresentado no capítulo anterior, são simples, e para que rodem melhor precisam de uma padronização e automação mínima, que a utilização do Redmine pode oferecer, e transformar o quadro de uma área inteira de um negócio.

\section{Cenário Complexo de Aprovação}\label{sec:cenario-complexo}

Apesar do grande potencial de configuração do Redmine e suportar a automatização de processos simples, não é possível utilizá-lo em situações de maior complexidade. O mapeamento de processos neste sistema é baseada em uma máquina de estados cujas transições são definidas apenas pelo estado corrente do processo e do perfil de acesso dos usuários. Portanto, fluxos mais complexos que possuem, por exemplo, atividades executadas em paralelo ou regras de negócio dependentes de variáveis do contexto de cada execução de um processo não são possíveis de ser modelados apenas com as configurações padrão do Redmine.

Nesses casos em que as funcionalidades padrão do Redmine não atendem aos requisitos de um processo, é possível estender as suas capacidades através da criação de plugins que ampliam as possibilidades de mapeamento de fluxos de negócio mais complicados.

Para o caso de uso descrito na seção \ref{sec:problema-caso_de_uso}, onde a solicitação de aprovação de precificação precisa da aprovação de 2 gestores, paralelamente, seria necessário o desenvolvimento de funcionalidades complementares às do Redmine para realizar a verificação de necessidade de aprovação (caso a alteração de preço seja superior a 30\%), criar tarefas distintas para aprovação de cada um dos gestores.

O uso de plugins para aumentar o poder de mapeamento de processos torna o Redmine uma ferramenta ainda mais flexível, permitindo utilizar todas as funcionalidades que já provê e acrescentando novas formas de controle de fluxos de processos. No entanto, muitos desses mecanismos adicionais criados com base nessa arquitetura já existem em outros tipos de ferramenta feitas com o propósito específico de gerenciamento de processo como são os BPMS.